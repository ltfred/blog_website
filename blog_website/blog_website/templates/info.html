
{% extends 'base.html' %}

{% block link %}
    <script src="{{ static('lib/prism/prism_patched.min.js') }}"></script>
    <link rel="stylesheet" href="{{ static('prism/prism.css') }}">
{% endblock link %}

{% block article %}
    <div class="lbox">
            <div class="content_box whitebg">
                <h2 class="htitle"><span class="con_nav">您现在的位置是：<a href="{{ url('index:index_list') }}">网站首页</a>><a
                        href="{{ url('article:category_list', args=(article.category1.id,1 )) }}">{{ article.category1.name }}></a><a
                        href="{{ url('article:category_list', args=(article.category2.id, 1)) }}">{{ article.category2.name }}</a></span>个人网站
                </h2>
                <h1 class="con_tilte">{{ article.title }}</h1>
                <p class="bloginfo"><i class="avatar"><img
                        src="{{ article.author.avatar_url }}"></i><span>{{ article.author.webname }}</span><span>{{ article.create_time | time_filter }}</span><span>【<a
                        href="{{ url('article:category_list', args=(article.category2.id, 1)) }}">{{ article.category2.name }}</a>】</span><span>{{ article.read_count }}人已围观</span>
                </p>
                <p class="con_info"><b>简介</b>个人网站，用来做什么？我刚开始就把它当做一个我吐槽心情的地方，也就相当于一个网络记事本，也会放上一些照片。后来也用来记录自己所学习的知识。
                </p>
                <div class="con_text">
                    <div class="highlight">
                        {{ article.content |safe }}
                    </div>
                    <p class="share"><b>转载：</b>感谢您对原创作品以及文章的青睐，非常欢迎各位朋友分享到个人站点或者朋友圈，但转载请说明文章出处“来源Fred个人网站”。</p>
                    <p><span class="diggit" onclick="like_article()"><a href="javascript:;">很赞哦！({{ article.like_count }})</a></span></p>
                    <div class="nextinfo">
                        {% if pre_article %}
                            <p>上一篇：<a
                                    href="{{ url('article:article_detail', args=(pre_article.id,)) }}">{{ pre_article.title }}</a>
                            </p>
                        {% endif %}
                        {% if next_article %}
                            <p>下一篇：<a
                                    href="{{ url('article:article_detail', args=(next_article.id,)) }}">{{ next_article.title }}</a>
                            </p>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="whitebg">
                <h2 class="htitle">相关文章</h2>
                <ul class="otherlink">
                    {% for article in articles %}
                        <li><a href="{{ url('article:article_detail', args=(article.id,)) }}"
                               title="{{ article.title }}">{{ article.title }}</a></li>
                    {% endfor %}
                </ul>
            </div>

            <div class="whitebg gbook">
                <h2 class="htitle">文章评论</h2>
                <ul>
                    <link rel="stylesheet" href="//c.fansx.com/tc.css"/>
                    <div id="tc_s77p{{ article.id }}"></div>
                    <script src="//c.fansx.com/?m=c1&sid=77&pid={{ article.id }}"></script>
                </ul>
            </div>
        </div>
{% endblock article %}

{% block endjs %}
    <script>
    function like_article() {
        var url = '/article/like/{{ article.id }}';
        axios.get(url, {
            responseType: 'json',
        })
            .then(response => {
                code = response.data.code;
                if (code == '4009') {
                    alert('只能点赞一次')
                } else {
                    window.location.reload();
                }

            })
            .catch(error => {
                console.log(error.response)
            })
    }
</script>
{% endblock endjs %}