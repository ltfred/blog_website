{% extends 'base.html' %}

{% block article %}
    <div class="lbox">
        <div class="whitebg bloglist">
            <h2 class="htitle">搜索结果</h2>
            <ul>
                <!--单图-->

                {% for result in page %}
                    <li>
                        <h3 class="blogtitle"><a
                                href="{{ url('article:article_detail', args=(result.object.id,)) }}"
                                target="_blank">{{ result.object.title }}</a></h3>
                        <span class="blogpic imgscale"><i><a
                                href="{{ url('article:category_list', args=(result.object.category1.id, 1)) }}">{{ result.object.category1.name }}</a></i><a
                                href="{{ url('article:article_detail', args=(result.object.id,)) }}"
                                title=""><img
                                src="{{ result.object.index_image }}" alt=""></a></span>
                        <p class="blogtext">{{ result.object.describe }} </p>
                        <p class="bloginfo"><i class="avatar"><img
                                src="{{ result.object.author.avatar_url }}"></i><span>{{ result.object.author.webname }}</span><span>{{ result.object.create_time | time_filter }}</span><span>【<a
                                href="{{ url('article:category_list', args=(result.object.category2.id, 1)) }}">{{ result.object.category2.name }}</a>】</span>
                        </p>
                        <a href="{{ url('article:article_detail', args=(result.object.id,)) }}"
                           class="viewmore">阅读更多</a>
                    </li>
                {% endfor %}

            </ul>
            <!--pagelist-->
{#            <div class="pagelist"><a title="Total record">&nbsp;<b>共{{ paginator.num_pages }}页</b> </a>&nbsp;&nbsp;&nbsp;#}
{#                <a href="#" onclick="nextpage()">下一页</a>&nbsp;#}
{#            </div>#}
            <div id="test1" style="margin:0 auto;text-align: center"></div>
            <!--pagelist end-->
        </div>

        <!--bloglist end-->
    </div>
    <div class="rbox">
    </div>
{% endblock %}

{% block tabel %}
{% endblock %}

{% block endjs %}
    <script>
        layui.use('laypage', function(){
            var laypage = layui.laypage;

            laypage.render({
                elem: 'test1'
                ,limit:10
                ,theme:'#34495e'
                ,count:  {{ total_count }}//数据总数，从服务端得到
                ,jump: function(obj, first){
                    //obj包含了当前分页的所有参数，比如：
                    console.log(obj.curr); //得到当前页，以便向服务端请求对应页的数据。
                    console.log(obj.limit); //得到每页显示的条数
                    //首次不执行
                    if(!first){
                        //do something
                        current_page = obj.curr
                        location.href = '/search?q={{ query }}&page=' + current_page
                    }
                }
            });
        });
    </script>
{% endblock %}