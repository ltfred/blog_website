{% extends 'base.html' %}

{% block article %}
    <div class="lbox">
        <div class="whitebg bloglist">
            <h2 class="htitle">搜索结果</h2>
            <ul>
                <!--单图-->

                {% for result in page %}
                    <li>
                        <h3 class="blogtitle"><a
                                href="{{ url('article:article_detail', args=(result.object.id,)) }}"
                                target="_blank">{{ result.object.title }}</a></h3>
                        <span class="blogpic imgscale"><i><a
                                href="{{ url('article:category_list', args=(result.object.category1.id, 1)) }}">{{ result.object.category1.name }}</a></i><a
                                href="{{ url('article:article_detail', args=(result.object.id,)) }}"
                                title=""><img
                                src="{{ result.object.index_image }}" alt=""></a></span>
                        <p class="blogtext">{{ result.object.describe }} </p>
                        <p class="bloginfo"><i class="avatar"><img
                                src="{{ result.object.author.avatar_url }}"></i><span>{{ result.object.author.webname }}</span><span>{{ result.object.create_time | time_filter }}</span><span>【<a
                                href="{{ url('article:category_list', args=(result.object.category2.id, 1)) }}">{{ result.object.category2.name }}</a>】</span>
                        </p>
                        <a href="{{ url('article:article_detail', args=(result.object.id,)) }}"
                           class="viewmore">阅读更多</a>
                    </li>
                {% endfor %}

            </ul>
            <!--pagelist-->
            <div class="pagelist"><a title="Total record">&nbsp;<b>共{{ paginator.num_pages }}页</b> </a>&nbsp;&nbsp;&nbsp;
                <a href="#" onclick="nextpage()">下一页</a>&nbsp;
            </div>
            <!--pagelist end-->
        </div>

        <!--bloglist end-->
    </div>
    <div class="rbox">
    </div>
{% endblock %}

{% block tabel %}
{% endblock %}

{% block endjs %}
    <script>
        function nextpage() {
            var curpage = {{ page.number }} +1;
            var total_page = {{ paginator.num_pages }};
            if (curpage > total_page) {
                alert('已经是最后一页了')
            } else {
                location.href = '/search/?q={{ query }}&page={{ page.number + 1 }}';
            }

        }
    </script>
{% endblock %}