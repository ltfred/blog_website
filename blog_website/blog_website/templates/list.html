{% extends 'base.html' %}

{% block link %}
        <script src="{{ static('js/page.js') }}"></script>
{% endblock link %}

{% block article %}
     <div class="lbox">
            <div class="whitebg lanmu"><img src="{{ category.image_url }}">
                <h1>{{ category.name }}</h1>
                <p>{{ category.describe }}</p>
            </div>
            <div class="whitebg bloglist">
                <h2 class="htitle"><span class="hnav">
      </span>{{ category.name }}</h2>
                <ul>
                    {% for article in articles %}
                        <li>
                            <h3 class="blogtitle"><a
                                    href="{{ url('article:article_detail', args=(article.article.id,)) }}"
                                    target="_blank">{{ article.article.title }}</a></h3>
                            <span class="blogpic imgscale"><i><a
                                    href="{{ url('article:category_list', args=(article.article.category1.id, 1)) }}">{{ article.article.category2.name }}</a></i><a
                                    href="{{ url('article:article_detail', args=(article.article.id,)) }}" title=""><img
                                    src="{{ article.article.index_image }}" alt=""></a></span>
                            <p class="blogtext">{{ article.article.describe }} </p>
                            <p class="bloginfo"><i class="avatar"><img
                                    src="{{ article.article.author.avatar_url }}"></i><span>{{ article.article.author.webname }}</span><span>{{ article.article.create_time | time_filter }}</span>
                                {% for label in article.labels %}
                                    <span>【<a href="{{ url('article:label_articles', args=(label.id, 1)) }}">{{ label.name }}</a>】</span>
                                {% endfor %}
                            </p>
                            <a href="{{ url('article:article_detail', args=(article.article.id,)) }}" class="viewmore">阅读更多</a>
                        </li>
                    {% endfor %}
                </ul>
                <div id="test1" style="margin:0 auto;text-align: center"></div>
            </div>

        </div>
{% endblock article %}

{% block endjs %}
    <script>
        layui.use('laypage', function(){
            var laypage = layui.laypage;

            laypage.render({
                elem: 'test1'
                ,limit:10
                ,theme:'#34495e'
                ,count:  {{ article_count }}//数据总数，从服务端得到
                ,jump: function(obj, first){
                    //obj包含了当前分页的所有参数，比如：
                    console.log(obj.curr); //得到当前页，以便向服务端请求对应页的数据。
                    console.log(obj.limit); //得到每页显示的条数
                    //首次不执行
                    if(!first){
                        //do something
                        current_page = obj.curr
                        location.href = '/list/' + {{ category_id }} +'/' + current_page + '/'
                    }
                }
            });
        });
    </script>
{% endblock endjs %}